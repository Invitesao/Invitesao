<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invites - Crie seu Site de Casamento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .dancing { font-family: 'Dancing Script', cursive; }
        .gradient-bg { background: linear-gradient(135deg, #5ba189 0%, #4a8b73 100%); }
        .card-shadow { box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        

    </style>
</head>
<body class="bg-gray-50">
    <!-- Configura√ß√£o do Supabase -->
    <script>
        // ‚ö†Ô∏è CONFIGURA√á√ÉO REAL DO PROJETO
        // URL base do GitHub Pages: araujo418.github.io/painel-invitesqr/?site=...
        const supabaseUrl = 'https://ybbhynfttwogkdsnqmvu.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InliYmh5bmZ0dHdvZ2tkc25xbXZ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ5NzI4NzAsImV4cCI6MjA1MDU0ODg3MH0.demo_key_for_presentation';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
        
        // Configura√ß√£o do GitHub Pages
        const GITHUB_BASE_URL = 'https://araujo418.github.io/painel-invitesqr/';
        
        // Detectar se estamos carregando um site espec√≠fico via par√¢metro
        const urlParams = new URLSearchParams(window.location.search);
        const siteParam = urlParams.get('site');
        
        // Estado global da aplica√ß√£o
        let isGitHubPages = window.location.hostname.includes('github.io');
        let currentSiteUrl = siteParam;
    </script>

    <!-- Navega√ß√£o -->
    <nav class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-green-600 dancing" style="color: #5ba189;">Invites</h1>
                </div>
                <div class="flex space-x-4">
                    <button onclick="showDemo()" class="text-gray-600 px-3 py-2 rounded-md text-sm font-medium" style="color: gray;" onmouseover="this.style.color='#5ba189'" onmouseout="this.style.color='gray'">
                        Ver Demo
                    </button>
                    <button onclick="showLogin()" class="text-gray-600 px-3 py-2 rounded-md text-sm font-medium" style="color: gray;" onmouseover="this.style.color='#5ba189'" onmouseout="this.style.color='gray'">
                        Login
                    </button>
                    <button onclick="showCreateWedding()" class="text-white px-4 py-2 rounded-md text-sm font-medium" style="background-color: #5ba189;" onmouseover="this.style.backgroundColor='#4a8b73'" onmouseout="this.style.backgroundColor='#5ba189'">
                        Criar Site
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- P√°gina Principal -->
    <div id="homePage" class="min-h-screen">
        <!-- Hero Section -->
        <div class="gradient-bg text-white py-20">
            <div class="max-w-4xl mx-auto text-center px-4">
                <h1 class="text-5xl md:text-6xl font-bold dancing mb-6">
                    Crie o Site Perfeito para seu Casamento
                </h1>
                <p class="text-xl mb-8 opacity-90">
                    Uma plataforma completa para confirma√ß√µes de presen√ßa
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="showCreateWedding()" class="bg-white px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition" style="color: #5ba189;">
                        Come√ßar Agora
                    </button>
                    <button onclick="showDemo()" class="border-2 border-white text-white px-8 py-3 rounded-lg font-semibold transition" style="border-color: white;" onmouseover="this.style.backgroundColor='white'; this.style.color='#5ba189'" onmouseout="this.style.backgroundColor='transparent'; this.style.color='white'">
                        Ver Demonstra√ß√£o
                    </button>
                </div>
            </div>
        </div>

        <!-- Por que escolher o Invites -->
        <div class="py-20 bg-white">
            <div class="max-w-6xl mx-auto px-4">
                <h2 class="text-3xl font-bold text-center mb-4 text-gray-800">
                    Por que escolher o Invites?
                </h2>
                <p class="text-center text-gray-600 mb-12 max-w-2xl mx-auto">
                    A plataforma mais completa para confirma√ß√µes de presen√ßa do seu casamento
                </p>
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="text-center p-6">
                        <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: rgba(91, 161, 137, 0.1);">
                            <span class="text-2xl">‚ú®</span>
                        </div>
                        <h3 class="text-xl font-semibold mb-3">Design Elegante</h3>
                        <p class="text-gray-600">Templates profissionais e personaliz√°veis que impressionam seus convidados</p>
                    </div>
                    <div class="text-center p-6">
                        <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: rgba(91, 161, 137, 0.1);">
                            <span class="text-2xl">‚è∞</span>
                        </div>
                        <h3 class="text-xl font-semibold mb-3">Cron√¥metro Autom√°tico</h3>
                        <p class="text-gray-600">Contagem regressiva em tempo real at√© o grande dia</p>
                    </div>
                    <div class="text-center p-6">
                        <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: rgba(91, 161, 137, 0.1);">
                            <span class="text-2xl">üì±</span>
                        </div>
                        <h3 class="text-xl font-semibold mb-3">Confirma√ß√µes Online</h3>
                        <p class="text-gray-600">Sistema RSVP inteligente com gest√£o completa de convidados</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Demonstra√ß√£o -->
        <div class="py-20 bg-gray-50">
            <div class="max-w-4xl mx-auto text-center px-4">
                <h2 class="text-3xl font-bold mb-6 text-gray-800">
                    üëÄ Veja como funciona
                </h2>
                <p class="text-lg text-gray-600 mb-8">
                    Explore nosso site de demonstra√ß√£o e veja todas as funcionalidades em a√ß√£o
                </p>
                <button onclick="showDemo()" class="text-white px-8 py-4 rounded-lg font-semibold transition text-lg" style="background-color: #5ba189;" onmouseover="this.style.backgroundColor='#4a8b73'" onmouseout="this.style.backgroundColor='#5ba189'">
                    Ver Site de Demonstra√ß√£o
                </button>
            </div>
        </div>
    </div>

    <!-- P√°gina de Cria√ß√£o de Casamento -->
    <div id="createWeddingPage" class="hidden min-h-screen py-12">
        <div class="max-w-2xl mx-auto px-4">
            <div class="bg-white rounded-lg card-shadow p-8">
                <h2 class="text-3xl font-bold text-center mb-8 dancing" style="color: #5ba189;">
                    Criar Seu Site de Casamento
                </h2>
                <form id="createWeddingForm" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Noivo</label>
                            <input type="text" id="groomName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2" style="--tw-ring-color: #5ba189;">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome da Noiva</label>
                            <input type="text" id="brideName" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2" style="--tw-ring-color: #5ba189;">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data do Casamento</label>
                        <input type="date" id="weddingDate" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2" style="border-color: #d1d5db; --tw-ring-color: #5ba189;">
                    </div>





                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">URL Personalizada</label>
                        <div class="flex">
                            <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm">
                                invites.com/
                            </span>
                            <input type="text" id="customUrl" required placeholder="joao-e-maria" class="flex-1 px-3 py-2 border border-gray-300 rounded-r-md focus:outline-none focus:ring-2" style="--tw-ring-color: #5ba189;">
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Ser√° gerada automaticamente baseada nos nomes</p>
                        <div id="urlStatus" class="text-xs mt-1 hidden"></div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Usu√°rio (Login)</label>
                            <input type="text" id="username" required minlength="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2" style="--tw-ring-color: #5ba189;">
                            <p class="text-xs text-gray-500 mt-1">M√≠nimo 3 caracteres</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                            <input type="password" id="password" required minlength="6" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2" style="--tw-ring-color: #5ba189;">
                            <p class="text-xs text-gray-500 mt-1">M√≠nimo 6 caracteres</p>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-purple-600 text-white py-3 rounded-md font-semibold hover:bg-purple-700 transition">
                        Criar Site de Casamento
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- P√°gina de Login -->
    <div id="loginPage" class="hidden min-h-screen py-12">
        <div class="max-w-md mx-auto px-4">
            <div class="bg-white rounded-lg card-shadow p-8">
                <h2 class="text-3xl font-bold text-center mb-8 dancing text-purple-600">
                    Acesso dos Noivos
                </h2>
                <form id="loginForm" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Usu√°rio</label>
                        <input type="text" id="loginUsername" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                        <input type="password" id="loginPassword" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>
                    <button type="submit" class="w-full bg-purple-600 text-white py-3 rounded-md font-semibold hover:bg-purple-700 transition">
                        Entrar no Painel
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Site de Demonstra√ß√£o -->
    <div id="demoPage" class="hidden min-h-screen">
        <!-- Header do Site de Casamento -->
        <div class="relative bg-gradient-to-br from-green-400 via-green-500 to-green-600 text-white py-20">
            <!-- Overlay escuro -->
            <div class="absolute inset-0 bg-black bg-opacity-30"></div>
            
            <!-- Bot√£o Login no canto superior direito -->
            <div class="absolute top-4 right-4 z-10">
                <button onclick="showLogin()" class="bg-white bg-opacity-20 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-opacity-30 transition backdrop-blur-sm">
                    Login
                </button>
            </div>
            
            <div class="relative z-10 max-w-4xl mx-auto text-center px-4">
                <div class="mb-6">
                    <span class="text-6xl animate-pulse">üíï</span>
                </div>
                <h1 class="text-6xl md:text-7xl font-bold dancing mb-6 couple-names">
                    Jo√£o & Maria
                </h1>
                <p class="text-2xl mb-8 font-medium">
                    Voc√™ est√° convidado para nosso casamento!
                </p>
                <div class="text-lg opacity-90 wedding-info">
                    15 de Junho de 2024 ‚Ä¢ 16:00
                </div>
            </div>
        </div>
        
        <!-- Contagem Regressiva -->
        <div class="py-12 bg-gray-50">
            <div class="max-w-4xl mx-auto px-4">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Contagem Regressiva</h2>
                    <p class="text-gray-600">Para o nosso grande dia</p>
                </div>
                
                <div id="countdownCards" class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-2xl mx-auto">
                    <div class="bg-white rounded-lg shadow-lg p-6 text-center border-t-4 border-purple-500">
                        <div id="days" class="text-3xl font-bold text-purple-600 mb-2">150</div>
                        <div class="text-gray-600 font-medium">Dias</div>
                    </div>
                    <div class="bg-white rounded-lg shadow-lg p-6 text-center border-t-4 border-blue-500">
                        <div id="hours" class="text-3xl font-bold text-blue-600 mb-2">12</div>
                        <div class="text-gray-600 font-medium">Horas</div>
                    </div>
                    <div class="bg-white rounded-lg shadow-lg p-6 text-center border-t-4 border-green-500">
                        <div id="minutes" class="text-3xl font-bold text-green-600 mb-2">30</div>
                        <div class="text-gray-600 font-medium">Minutos</div>
                    </div>
                    <div class="bg-white rounded-lg shadow-lg p-6 text-center border-t-4 border-red-500">
                        <div id="seconds" class="text-3xl font-bold text-red-600 mb-2">45</div>
                        <div class="text-gray-600 font-medium">Segundos</div>
                    </div>
                </div>
                
                <div id="weddingDayMessage" class="hidden text-center mt-8">
                    <div class="bg-white rounded-lg shadow-lg p-8 max-w-md mx-auto">
                        <div class="text-4xl mb-4">üéâ</div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">O grande dia chegou!</h3>
                        <p class="text-gray-600">Hoje √© o nosso casamento!</p>
                        <div class="text-4xl mt-4">üéâ</div>
                    </div>
                </div>
            </div>
        </div>



        <!-- Se√ß√£o RSVP -->
        <div id="rsvpSection" class="py-12 bg-gray-50">
            <div class="max-w-lg mx-auto px-4">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold dancing text-purple-600 mb-3">
                        Confirme sua Presen√ßa
                    </h2>
                    <p class="text-gray-600 text-sm">Sua confirma√ß√£o √© muito importante para n√≥s!</p>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <form id="rsvpForm" class="space-y-6">
                        <!-- Nome do Convidado -->
                        <div>
                            <label class="block text-base font-medium text-gray-700 mb-2">Seu Nome</label>
                            <input type="text" id="guestName" required placeholder="Digite seu nome completo" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-base">
                        </div>
                        
                        <!-- Op√ß√µes de Presen√ßa -->
                        <div>
                            <label class="block text-base font-medium text-gray-700 mb-3">Voc√™ vir√°?</label>
                            <div class="grid grid-cols-1 gap-3">
                                <label class="relative cursor-pointer">
                                    <input type="radio" name="attendance" value="yes" class="sr-only peer">
                                    <div class="bg-gray-50 border-2 border-gray-200 rounded-lg p-4 text-center transition-all peer-checked:border-green-500 peer-checked:bg-green-50 active:scale-95">
                                        <div class="text-2xl mb-2">‚úÖ</div>
                                        <div class="font-semibold text-gray-800 mb-1">Vou comparecer</div>
                                        <div class="text-xs text-gray-600">Estarei presente no grande dia!</div>
                                    </div>
                                </label>
                                
                                <label class="relative cursor-pointer">
                                    <input type="radio" name="attendance" value="no" class="sr-only peer">
                                    <div class="bg-gray-50 border-2 border-gray-200 rounded-lg p-4 text-center transition-all peer-checked:border-red-500 peer-checked:bg-red-50 active:scale-95">
                                        <div class="text-2xl mb-2">‚ùå</div>
                                        <div class="font-semibold text-gray-800 mb-1">N√£o poderei ir</div>
                                        <div class="text-xs text-gray-600">Infelizmente n√£o conseguirei comparecer</div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Se√ß√£o de Acompanhantes -->
                        <div id="companionSection" class="hidden space-y-4">
                            <div>
                                <label class="block text-base font-medium text-gray-700 mb-3">Acompanhantes</label>
                                <div class="space-y-2">
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg border border-gray-200 cursor-pointer active:scale-95 transition-all">
                                        <input type="radio" name="companionType" value="none" checked class="text-purple-600 focus:ring-purple-500">
                                        <span class="ml-3 text-sm font-medium">Nenhum acompanhante</span>
                                    </label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg border border-gray-200 cursor-pointer active:scale-95 transition-all">
                                        <input type="radio" name="companionType" value="one" class="text-purple-600 focus:ring-purple-500">
                                        <span class="ml-3 text-sm font-medium">1 acompanhante</span>
                                    </label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg border border-gray-200 cursor-pointer active:scale-95 transition-all">
                                        <input type="radio" name="companionType" value="multiple" class="text-purple-600 focus:ring-purple-500">
                                        <span class="ml-3 text-sm font-medium">M√∫ltiplos acompanhantes</span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Campo para um acompanhante -->
                            <div id="oneCompanionSection" class="hidden">
                                <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Acompanhante</label>
                                    <input type="text" id="companionName" placeholder="Nome completo do acompanhante" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm">
                                </div>
                            </div>
                            
                            <!-- Seletor para m√∫ltiplos acompanhantes -->
                            <div id="multipleCompanionsSection" class="hidden">
                                <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">N√∫mero de Acompanhantes</label>
                                    <select id="companionCount" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 mb-3 text-sm">
                                        <option value="0">Nenhum</option>
                                        <option value="1">1 pessoa</option>
                                        <option value="2">2 pessoas</option>
                                        <option value="3">3 pessoas</option>
                                        <option value="4">4 pessoas</option>
                                        <option value="5">5 pessoas</option>
                                        <option value="6">6 pessoas</option>
                                        <option value="7">7 pessoas</option>
                                        <option value="8">8 pessoas</option>
                                        <option value="9">9 pessoas</option>
                                        <option value="10">10 pessoas</option>
                                    </select>
                                    
                                    <!-- Campos din√¢micos para nomes dos acompanhantes -->
                                    <div id="companionNamesContainer" class="space-y-2">
                                        <!-- Os campos ser√£o adicionados dinamicamente -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Mensagem para os Noivos -->
                        <div>
                            <label class="block text-base font-medium text-gray-700 mb-2">Mensagem para os Noivos</label>
                            <textarea id="rsvpMessage" rows="3" placeholder="Deixe uma mensagem carinhosa..." class="w-full px-3 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none text-sm"></textarea>
                            <p class="text-xs text-gray-500 mt-1">üíå Esta mensagem ser√° exibida no mural de recados</p>
                        </div>

                        <!-- Bot√£o de Confirma√ß√£o -->
                        <button type="submit" class="w-full bg-gradient-to-r from-purple-600 to-purple-700 text-white py-4 rounded-lg font-bold text-base hover:from-purple-700 hover:to-purple-800 transition-all active:scale-95 shadow-lg">
                            üíå Confirmar Presen√ßa
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Se√ß√£o de Presentes -->
        <div id="giftsSection" class="py-16 bg-white">
            <div class="max-w-2xl mx-auto px-4">
                <div class="text-center mb-10">
                    <h2 class="text-4xl font-bold dancing text-purple-600 mb-4">
                        üéÅ Lista de Presentes
                    </h2>
                    <p class="text-gray-600">A sua presen√ßa j√° √© um presente especial para n√≥s</p>
                </div>
                
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl shadow-lg p-6 border border-purple-100">
                    <div class="text-center mb-6">
                        <div class="text-6xl mb-4">üíù</div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">A sua presen√ßa j√° √© um presente especial!</h3>
                        <p class="text-gray-600 text-lg leading-relaxed mb-6">
                            Mas caso ainda assim desejar nos presentear, pedimos que o fa√ßa por transfer√™ncia banc√°ria.
                        </p>
                    </div>
                    
                    <div class="bg-white rounded-lg p-6 shadow-md border-l-4 border-purple-500">
                        <h4 class="font-bold text-gray-800 mb-4 flex items-center">
                            <span class="text-2xl mr-2">üè¶</span>
                            Dados Banc√°rios
                        </h4>
                        
                        <div class="space-y-3">
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-medium text-gray-700 mb-1 sm:mb-0">Titular da Conta:</span>
                                <span class="font-bold text-gray-900 text-sm sm:text-base" id="accountHolder">Jo√£o Silva Santos</span>
                            </div>
                            
                            <div class="p-3 bg-gray-50 rounded-lg">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-medium text-gray-700">IBAN:</span>
                                    <button onclick="copyIBAN()" class="text-purple-600 hover:text-purple-700 p-1 rounded transition">
                                        <span class="text-sm">üìã</span>
                                    </button>
                                </div>
                                <span class="font-mono text-sm text-gray-900 break-all" id="ibanDisplay">AO06 0040 0000 1234 5678 1011 2</span>
                            </div>
                        </div>
                        
                        <div class="mt-4 p-3 bg-purple-50 rounded-lg border border-purple-200">
                            <p class="text-xs text-purple-800 text-center">
                                <span class="font-semibold">üí° Dica:</span> Toque no √≠cone üìã para copiar o IBAN
                            </p>
                        </div>
                    </div>
                    
                    <div class="text-center mt-6">
                        <p class="text-gray-600 italic text-sm">
                            "O vosso amor e carinho s√£o os maiores presentes que podemos receber!" ‚ù§Ô∏è
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mural de Recados -->
        <div id="messagesSection" class="py-16 bg-gray-50">
            <div class="max-w-4xl mx-auto px-4">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold dancing text-purple-600 mb-4">
                        Mural de Recados
                    </h2>
                    <p class="text-gray-600">Deixe uma mensagem especial para os noivos</p>
                </div>

                <!-- Lista de Mensagens -->
                <div id="messagesList" class="space-y-6 mb-12">
                    <!-- Mensagens de exemplo -->
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500">
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0">
                                <span class="text-purple-600 font-bold text-lg">A</span>
                            </div>
                            <div class="flex-1">
                                <div class="flex justify-between items-start mb-2">
                                    <h4 class="font-bold text-gray-800 text-lg">Ana Silva</h4>
                                    <span class="text-sm text-gray-500">h√° 2 dias</span>
                                </div>
                                <p class="text-gray-700 leading-relaxed">Que alegria saber do casamento de voc√™s! Desejo toda felicidade do mundo para este novo cap√≠tulo. Mal posso esperar para celebrar com voc√™s! üíï</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500">
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                                <span class="text-blue-600 font-bold text-lg">C</span>
                            </div>
                            <div class="flex-1">
                                <div class="flex justify-between items-start mb-2">
                                    <h4 class="font-bold text-gray-800 text-lg">Carlos Mendes</h4>
                                    <span class="text-sm text-gray-500">h√° 1 semana</span>
                                </div>
                                <p class="text-gray-700 leading-relaxed">Jo√£o e Maria, voc√™s s√£o um casal incr√≠vel! Que Deus aben√ßoe esta uni√£o e que seja repleta de amor, cumplicidade e muitas alegrias. Parab√©ns! üéâ</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500">
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">
                                <span class="text-green-600 font-bold text-lg">M</span>
                            </div>
                            <div class="flex-1">
                                <div class="flex justify-between items-start mb-2">
                                    <h4 class="font-bold text-gray-800 text-lg">Mariana Costa</h4>
                                    <span class="text-sm text-gray-500">h√° 3 dias</span>
                                </div>
                                <p class="text-gray-700 leading-relaxed">Estou muito emocionada com este momento! Voc√™s merecem toda felicidade do mundo. Que seja uma uni√£o aben√ßoada e cheia de amor! ‚ù§Ô∏è</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Mensagem quando n√£o h√° recados -->
                <div id="noMessagesMessage" class="hidden text-center py-12">
                    <div class="text-6xl mb-4">üíå</div>
                    <h3 class="text-xl font-semibold text-gray-700 mb-2">Ainda n√£o h√° mensagens</h3>
                    <p class="text-gray-500">Seja o primeiro a deixar um recado especial para os noivos!</p>
                </div>
            </div>
        </div>



        <!-- Rodap√© do Site de Casamento -->
        <footer class="bg-gradient-to-r from-purple-800 to-purple-900 text-white py-12">
            <div class="max-w-4xl mx-auto text-center px-4">
                <div class="mb-6">
                    <div class="text-4xl mb-4">üíï</div>
                    <h3 class="text-4xl font-bold dancing text-purple-200 couple-names mb-2">Jo√£o & Maria</h3>
                    <p class="text-xl text-purple-100 wedding-info">15 de junho de 2024 ‚Ä¢ Com amor</p>
                </div>
                <div class="border-t border-purple-700 pt-6">
                    <p class="text-sm text-purple-300">
                        Created by <span class="font-semibold">Invites</span> ‚Ä¢ 2025
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Dashboard Administrativo -->
    <div id="dashboardPage" class="hidden min-h-screen bg-gray-50">
        <!-- Header do Dashboard -->
        <div class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <h1 class="text-2xl font-bold text-purple-600 dancing">Painel Administrativo</h1>
                    <div class="flex items-center space-x-4">
                        <span class="text-gray-600">Jo√£o & Maria</span>
                        <button onclick="copySiteUrl()" class="text-white px-3 py-1 rounded text-sm font-medium transition" style="background-color: #5ba189;" onmouseover="this.style.backgroundColor='#4a8b73'" onmouseout="this.style.backgroundColor='#5ba189'">
                            üìã Copiar URL
                        </button>
                        <button onclick="showDemo()" class="text-purple-600 hover:text-purple-700">Ver Site</button>
                        <button onclick="showHome()" class="text-gray-600 hover:text-gray-700">Sair</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navega√ß√£o do Dashboard -->
        <div class="bg-white border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8">
                    <button onclick="showDashboardTab('stats')" id="statsTab" class="py-4 px-1 border-b-2 border-purple-500 text-purple-600 font-medium">
                        Estat√≠sticas
                    </button>
                    <button onclick="showDashboardTab('guests')" id="guestsTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
                        Convidados
                    </button>
                    <button onclick="showDashboardTab('messages')" id="messagesTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
                        Mensagens
                    </button>
                    <button onclick="showDashboardTab('settings')" id="settingsTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
                        Configura√ß√µes
                    </button>
                </div>
            </div>
        </div>

        <!-- Conte√∫do do Dashboard -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            
            <!-- Aba de Estat√≠sticas -->
            <div id="statsContent" class="dashboard-content">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                    <span class="text-green-600 font-semibold">‚úÖ</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-500">Confirmados</p>
                                <p class="text-2xl font-semibold text-gray-900" data-stat="confirmed">47</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-red-100 rounded-full flex items-center justify-center">
                                    <span class="text-red-600 font-semibold">‚ùå</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-500">N√£o Confirmados</p>
                                <p class="text-2xl font-semibold text-gray-900" data-stat="declined">8</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                    <span class="text-blue-600 font-semibold">üë•</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-500">Total Pessoas</p>
                                <p class="text-2xl font-semibold text-gray-900" data-stat="total">62</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                    <span class="text-purple-600 font-semibold">üíå</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-500">Mensagens</p>
                                <p class="text-2xl font-semibold text-gray-900" data-stat="messages">23</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg card-shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">Confirma√ß√µes por Dia</h3>
                    <div class="h-64 flex items-end justify-between space-x-2">
                        <div class="flex flex-col items-center">
                            <div class="w-8 bg-purple-500 rounded-t" style="height: 60px;"></div>
                            <span class="text-xs text-gray-500 mt-2">Seg</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-8 bg-purple-500 rounded-t" style="height: 80px;"></div>
                            <span class="text-xs text-gray-500 mt-2">Ter</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-8 bg-purple-500 rounded-t" style="height: 120px;"></div>
                            <span class="text-xs text-gray-500 mt-2">Qua</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-8 bg-purple-500 rounded-t" style="height: 40px;"></div>
                            <span class="text-xs text-gray-500 mt-2">Qui</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-8 bg-purple-500 rounded-t" style="height: 100px;"></div>
                            <span class="text-xs text-gray-500 mt-2">Sex</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-8 bg-purple-500 rounded-t" style="height: 160px;"></div>
                            <span class="text-xs text-gray-500 mt-2">S√°b</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="w-8 bg-purple-500 rounded-t" style="height: 90px;"></div>
                            <span class="text-xs text-gray-500 mt-2">Dom</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba de Convidados -->
            <div id="guestsContent" class="dashboard-content hidden">
                <div class="bg-white rounded-lg card-shadow">
                    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="text-lg font-semibold">Lista de Convidados</h3>
                        <button onclick="exportCSV()" class="bg-purple-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-purple-700">
                            Exportar CSV
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table id="guestsTable" class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acompanhante</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Ana Silva</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                            Confirmado
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Pedro Silva</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">10/05/2024</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Carlos Mendes</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                            Confirmado
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">08/05/2024</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Lucia Santos</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                            N√£o Confirmado
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">12/05/2024</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Aba de Mensagens do Dashboard -->
            <div id="dashboardMessagesContent" class="dashboard-content hidden">
                <div class="bg-white rounded-lg card-shadow p-6">
                    <h3 class="text-lg font-semibold mb-6">Mensagens dos Convidados</h3>
                    <div class="space-y-4">
                        <div class="border-l-4 border-purple-500 pl-4 py-2">
                            <div class="flex justify-between items-start mb-1">
                                <h4 class="font-semibold text-gray-800">Ana Silva</h4>
                                <span class="text-sm text-gray-500">10/05/2024</span>
                            </div>
                            <p class="text-gray-600">Que alegria saber do casamento de voc√™s! Desejo toda felicidade do mundo para este novo cap√≠tulo. Mal posso esperar para celebrar com voc√™s! üíï</p>
                        </div>
                        
                        <div class="border-l-4 border-purple-500 pl-4 py-2">
                            <div class="flex justify-between items-start mb-1">
                                <h4 class="font-semibold text-gray-800">Carlos Mendes</h4>
                                <span class="text-sm text-gray-500">08/05/2024</span>
                            </div>
                            <p class="text-gray-600">Jo√£o e Maria, voc√™s s√£o um casal incr√≠vel! Que Deus aben√ßoe esta uni√£o e que seja repleta de amor, cumplicidade e muitas alegrias. Parab√©ns! üéâ</p>
                        </div>
                        
                        <div class="border-l-4 border-purple-500 pl-4 py-2">
                            <div class="flex justify-between items-start mb-1">
                                <h4 class="font-semibold text-gray-800">Roberto Lima</h4>
                                <span class="text-sm text-gray-500">07/05/2024</span>
                            </div>
                            <p class="text-gray-600">Estou muito feliz por voc√™s! Que este seja o in√≠cio de uma jornada maravilhosa juntos. Conte comigo para o que precisarem! ‚ù§Ô∏è</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba de Configura√ß√µes -->
            <div id="settingsContent" class="dashboard-content hidden">
                <!-- URL do Site -->
                <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4">üîó URL do Seu Site</h3>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <p class="text-sm text-gray-600 mb-1">Compartilhe este link com seus convidados:</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-gray-500 text-sm">invites.com/</span>
                                    <p id="siteUrlDisplay" class="font-mono text-sm break-all" style="color: #5ba189;">
                                        joao-e-maria
                                    </p>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">Link completo ser√° copiado ao clicar em "Copiar"</p>
                            </div>
                            <button onclick="copySiteUrl()" class="ml-4 text-white px-4 py-2 rounded-md text-sm font-medium transition" style="background-color: #5ba189;" onmouseover="this.style.backgroundColor='#4a8b73'" onmouseout="this.style.backgroundColor='#5ba189'">
                                üìã Copiar
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Aviso de Seguran√ßa -->
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <span class="text-yellow-400">‚ö†Ô∏è</span>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-yellow-800">Aviso de Seguran√ßa</h3>
                            <div class="mt-2 text-sm text-yellow-700">
                                <p>‚Ä¢ As senhas s√£o armazenadas sem criptografia no banco de dados</p>
                                <p>‚Ä¢ Recomenda-se usar senhas simples e n√£o reutilizar senhas importantes</p>
                                <p>‚Ä¢ Este √© um projeto de demonstra√ß√£o - para uso comercial, implemente seguran√ßa adequada</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg card-shadow p-6">
                    <h3 class="text-lg font-semibold mb-6">Configura√ß√µes do Site</h3>
                    <form class="space-y-6">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Noivo</label>
                                <input type="text" value="Jo√£o" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nome da Noiva</label>
                                <input type="text" value="Maria" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Data do Casamento</label>
                                <input type="date" value="2024-06-15" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Hor√°rio</label>
                                <input type="time" value="16:00" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Local da Cerim√¥nia</label>
                            <input type="text" value="Igreja S√£o Jos√©, Centro da Cidade" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">URL Personalizada</label>
                            <div class="flex">
                                <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm">
                                    invites.com/
                                </span>
                                <input type="text" value="joao-e-maria" class="flex-1 px-3 py-2 border border-gray-300 rounded-r-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Mensagem de Confirma√ß√£o</label>
                            <textarea rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">Obrigado por confirmar sua presen√ßa! Estamos ansiosos para celebrar este momento especial com voc√™.</textarea>
                        </div>

                        <!-- Configura√ß√µes de Acompanhantes -->
                        <div class="border-t pt-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">üë• Configura√ß√µes de Acompanhantes</h4>
                            
                            <div class="space-y-4">
                                <div class="flex items-center space-x-3">
                                    <input type="checkbox" id="allowCompanions" checked class="w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                                    <label for="allowCompanions" class="text-sm font-medium text-gray-700">
                                        Permitir que convidados tragam acompanhantes
                                    </label>
                                </div>
                                
                                <div id="companionsConfig" class="space-y-4 ml-7">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-3">Limite de Acompanhantes</label>
                                        <div class="space-y-2">
                                            <label class="flex items-center">
                                                <input type="radio" name="companionLimit" value="unlimited" checked class="text-purple-600 focus:ring-purple-500">
                                                <span class="ml-2 text-sm text-gray-700">Sem limite (convidados escolhem quantos quiserem)</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="companionLimit" value="fixed" class="text-purple-600 focus:ring-purple-500">
                                                <span class="ml-2 text-sm text-gray-700">Limite fixo:</span>
                                                <select id="maxCompanions" class="ml-2 px-2 py-1 border border-gray-300 rounded text-sm">
                                                    <option value="1">1 acompanhante</option>
                                                    <option value="2">2 acompanhantes</option>
                                                    <option value="3">3 acompanhantes</option>
                                                    <option value="4">4 acompanhantes</option>
                                                    <option value="5">5 acompanhantes</option>
                                                    <option value="10">10 acompanhantes</option>
                                                </select>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center space-x-3">
                                        <input type="checkbox" id="requireCompanionNames" checked class="w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                                        <label for="requireCompanionNames" class="text-sm font-medium text-gray-700">
                                            Solicitar nomes dos acompanhantes
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Configura√ß√µes de Presentes -->
                        <div class="border-t pt-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">üéÅ Configura√ß√µes de Presentes</h4>
                            
                            <div class="space-y-4">
                                <div class="flex items-center space-x-3">
                                    <input type="checkbox" id="enableGifts" checked class="w-4 h-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                                    <label for="enableGifts" class="text-sm font-medium text-gray-700">
                                        Mostrar se√ß√£o de presentes no site
                                    </label>
                                </div>
                                
                                <div id="giftsConfig" class="space-y-4 ml-7">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Titular da Conta</label>
                                        <input type="text" id="accountHolderInput" value="Jo√£o Silva Santos" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">IBAN</label>
                                        <input type="text" id="ibanInput" value="AO06 0040 0000 1234 5678 1011 2" placeholder="AO06 0000 0000 0000 0000 0000 0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 font-mono text-sm">
                                        <p class="text-xs text-gray-500 mt-1">Formato: AO + 23 d√≠gitos (IBAN angolano)</p>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Mensagem Personalizada (Opcional)</label>
                                        <textarea id="giftMessage" rows="2" placeholder="Mensagem adicional para os convidados..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="bg-purple-600 text-white px-6 py-2 rounded-md font-semibold hover:bg-purple-700 transition">
                            Salvar Altera√ß√µes
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Rodap√© do Site de Casamento -->
        <footer class="bg-gradient-to-r from-purple-800 to-purple-900 text-white py-12">
            <div class="max-w-4xl mx-auto text-center px-4">
                <div class="mb-6">
                    <div class="text-4xl mb-4">üíï</div>
                    <h3 class="text-4xl font-bold dancing text-purple-200 couple-names mb-2">Jo√£o & Maria</h3>
                    <p class="text-xl text-purple-100 wedding-info">15 de junho de 2024 ‚Ä¢ Com amor</p>
                </div>
                <div class="border-t border-purple-700 pt-6">
                    <p class="text-sm text-purple-300">
                        Created by <span class="font-semibold">Invites</span> ‚Ä¢ 2025
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Estado da aplica√ß√£o
        let currentWedding = null;
        let currentUser = null;
        let countdownInterval = null;

        // ========== SISTEMA DE ROTEAMENTO GITHUB PAGES ==========
        function initializeApp() {
            // Se h√° par√¢metro 'site', carregar site espec√≠fico
            if (currentSiteUrl) {
                loadWeddingSiteByUrl(currentSiteUrl);
            } else {
                showHome();
            }
        }
        
        async function loadWeddingSiteByUrl(customUrl) {
            try {
                const result = await getWeddingByUrl(customUrl);
                if (result.success) {
                    currentWedding = result.wedding;
                    showWeddingSite(result.wedding);
                } else {
                    // Site n√£o encontrado, mostrar erro
                    showSiteNotFound();
                }
            } catch (error) {
                console.error('Erro ao carregar site:', error);
                showSiteNotFound();
            }
        }
        
        function showSiteNotFound() {
            hideAllPages();
            document.body.innerHTML = `
                <div class="min-h-screen flex items-center justify-center bg-gray-50">
                    <div class="text-center">
                        <h1 class="text-4xl font-bold text-gray-800 mb-4">Site n√£o encontrado</h1>
                        <p class="text-gray-600 mb-8">O site de casamento que voc√™ est√° procurando n√£o existe ou foi removido.</p>
                        <a href="${GITHUB_BASE_URL}" class="bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-purple-700 transition">
                            Voltar ao In√≠cio
                        </a>
                    </div>
                </div>
            `;
        }
        
        function generateSiteUrl(customUrl) {
            return `${GITHUB_BASE_URL}?site=${customUrl}`;
        }

        // ========== FUN√á√ïES DE NAVEGA√á√ÉO ==========
        function showHome() {
            hideAllPages();
            document.getElementById('homePage').classList.remove('hidden');
        }

        function showCreateWedding() {
            hideAllPages();
            document.getElementById('createWeddingPage').classList.remove('hidden');
            generateUrl();
        }

        function showLogin() {
            hideAllPages();
            document.getElementById('loginPage').classList.remove('hidden');
        }

        function showDemo() {
            hideAllPages();
            document.getElementById('demoPage').classList.remove('hidden');
            startCountdown('2024-06-15', '16:00');
        }
        
        function clearCompanion() {
            document.getElementById('companionName').value = '';
        }

        function showDashboard() {
            hideAllPages();
            document.getElementById('dashboardPage').classList.remove('hidden');
            showDashboardTab('stats');
            loadDashboardData();
        }

        function showWeddingSite(weddingData) {
            hideAllPages();
            document.getElementById('demoPage').classList.remove('hidden');
            updateWeddingSiteContent(weddingData);
            showSection('rsvp');
            startCountdown(weddingData.wedding_date, weddingData.wedding_time);
        }

        function hideAllPages() {
            const pages = ['homePage', 'createWeddingPage', 'loginPage', 'demoPage', 'dashboardPage'];
            pages.forEach(page => {
                document.getElementById(page).classList.add('hidden');
            });
            
            // Limpar countdown anterior
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }
        }

        // ========== FUN√á√ïES DO SITE DE CASAMENTO ==========
        function showSection(section) {
            const sections = ['rsvpSection', 'messagesSection', 'detailsSection'];
            sections.forEach(s => {
                document.getElementById(s).classList.add('hidden');
            });
            document.getElementById(section + 'Section').classList.remove('hidden');
        }

        function updateWeddingSiteContent(data) {
            // Atualizar nomes dos noivos
            const coupleNames = document.querySelectorAll('.couple-names');
            coupleNames.forEach(element => {
                element.textContent = `${data.groom_name} & ${data.bride_name}`;
            });
            
            // Atualizar data
            const weddingInfo = document.querySelectorAll('.wedding-info');
            const formattedDate = new Date(data.wedding_date).toLocaleDateString('pt-BR');
            weddingInfo.forEach(element => {
                element.textContent = `${formattedDate} ‚Ä¢ Com amor`;
            });
            
            // Configurar se√ß√£o de presentes
            updateGiftsSection(data);
            
            // Configurar formul√°rio RSVP
            updateRSVPForm(data);
        }

        function updateGiftsSection(data) {
            const giftsSection = document.getElementById('giftsSection');
            
            // Mostrar/esconder se√ß√£o baseado na configura√ß√£o
            if (data.gifts_enabled === false) {
                giftsSection.style.display = 'none';
            } else {
                giftsSection.style.display = 'block';
                
                // Atualizar dados banc√°rios se dispon√≠veis
                if (data.account_holder) {
                    document.getElementById('accountHolder').textContent = data.account_holder;
                }
                if (data.iban) {
                    document.getElementById('ibanDisplay').textContent = data.iban;
                }
            }
        }



        function updateRSVPForm(data) {
            const companionSection = document.getElementById('companionSection');
            if (!data.allow_companions) {
                companionSection.style.display = 'none';
            } else {
                companionSection.style.display = 'block';
                
                // Configurar tipo de acompanhante
                const multipleOption = document.querySelector('input[value="multiple"]').parentElement;
                if (data.companion_type === 'single') {
                    multipleOption.style.display = 'none';
                } else {
                    multipleOption.style.display = 'block';
                }
            }
        }

        // ========== FUN√á√ïES DO DASHBOARD ==========
        function showDashboardTab(tab) {
            const tabs = ['statsTab', 'guestsTab', 'messagesTab', 'settingsTab'];
            tabs.forEach(t => {
                const tabElement = document.getElementById(t);
                tabElement.classList.remove('border-purple-500', 'text-purple-600');
                tabElement.classList.add('border-transparent', 'text-gray-500');
            });
            
            const activeTab = document.getElementById(tab + 'Tab');
            activeTab.classList.remove('border-transparent', 'text-gray-500');
            activeTab.classList.add('border-purple-500', 'text-purple-600');
            
            const contents = document.querySelectorAll('.dashboard-content');
            contents.forEach(content => content.classList.add('hidden'));
            
            const contentMap = {
                'stats': 'statsContent',
                'guests': 'guestsContent',
                'messages': 'dashboardMessagesContent',
                'settings': 'settingsContent'
            };
            
            document.getElementById(contentMap[tab]).classList.remove('hidden');
        }

        async function loadDashboardData() {
            if (!currentWedding) return;
            
            // Atualizar URL do site
            updateSiteUrlDisplay();
            
            try {
                // Carregar RSVPs e mensagens
                const [rsvpsResult, messagesResult] = await Promise.all([
                    getRSVPs(currentWedding.id),
                    getMessages(currentWedding.id)
                ]);
                
                if (rsvpsResult.success) {
                    updateStatsCards(rsvpsResult.rsvps);
                    updateGuestsList(rsvpsResult.rsvps);
                }
                
                if (messagesResult.success) {
                    updateMessagesList(messagesResult.messages);
                }
            } catch (error) {
                console.error('Erro ao carregar dados do dashboard:', error);
            }
        }

        function updateStatsCards(rsvps) {
            const confirmed = rsvps.filter(r => r.attendance).length;
            const declined = rsvps.filter(r => !r.attendance).length;
            const totalPeople = rsvps.reduce((sum, r) => sum + (r.attendance ? r.guest_count : 0), 0);
            
            const confirmedEl = document.querySelector('[data-stat="confirmed"]');
            const declinedEl = document.querySelector('[data-stat="declined"]');
            const totalEl = document.querySelector('[data-stat="total"]');
            
            if (confirmedEl) confirmedEl.textContent = confirmed;
            if (declinedEl) declinedEl.textContent = declined;
            if (totalEl) totalEl.textContent = totalPeople;
        }

        function updateGuestsList(rsvps) {
            const tbody = document.querySelector('#guestsTable tbody');
            tbody.innerHTML = '';
            
            rsvps.forEach(rsvp => {
                const row = document.createElement('tr');
                
                // Formatear acompanhantes
                let companionsDisplay = '-';
                if (rsvp.companion_name) {
                    const companions = rsvp.companion_name.split(', ');
                    if (companions.length === 1) {
                        companionsDisplay = companions[0];
                    } else {
                        companionsDisplay = `${companions.length} pessoas: ${companions.join(', ')}`;
                    }
                }
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${rsvp.guest_name}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${rsvp.attendance ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${rsvp.attendance ? 'Confirmado' : 'N√£o Confirmado'}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-500" style="max-width: 200px; word-wrap: break-word;">${companionsDisplay}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(rsvp.created_at).toLocaleDateString('pt-BR')}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateMessagesList(messages) {
            const container = document.getElementById('dashboardMessagesContent').querySelector('.space-y-4');
            container.innerHTML = '';
            
            messages.forEach(message => {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'border-l-4 border-purple-500 pl-4 py-2';
                messageDiv.innerHTML = `
                    <div class="flex justify-between items-start mb-1">
                        <h4 class="font-semibold text-gray-800">${message.guest_name}</h4>
                        <span class="text-sm text-gray-500">${getTimeAgo(message.created_at)}</span>
                    </div>
                    <p class="text-gray-600">${message.message}</p>
                `;
                container.appendChild(messageDiv);
            });
        }

        // ========== UTILIT√ÅRIOS ==========
        function generateCustomUrl(groom, bride) {
            return (groom + '-e-' + bride)
                .toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .replace(/[^a-z0-9]/g, '-')
                .replace(/-+/g, '-')
                .replace(/^-|-$/g, '');
        }

        function updateUrlPreview() {
            const groomName = document.getElementById('groomName');
            const brideName = document.getElementById('brideName');
            const customUrl = document.getElementById('customUrl');
            const urlStatus = document.getElementById('urlStatus');
            
            function updateUrl() {
                if (groomName.value && brideName.value) {
                    const url = generateCustomUrl(groomName.value, brideName.value);
                    customUrl.value = url;
                    checkUrlAvailabilityStatus(url);
                }
            }
            
            async function checkUrlAvailabilityStatus(url) {
                if (url) {
                    urlStatus.classList.remove('hidden');
                    urlStatus.innerHTML = '<span class="text-blue-500">Verificando disponibilidade...</span>';
                    
                    const result = await checkUrlAvailability(url);
                    if (result.available) {
                        urlStatus.innerHTML = '<span class="text-green-500">‚úì URL dispon√≠vel</span>';
                    } else {
                        urlStatus.innerHTML = '<span class="text-red-500">‚úó URL j√° existe</span>';
                    }
                }
            }
            
            groomName.addEventListener('input', updateUrl);
            brideName.addEventListener('input', updateUrl);
            customUrl.addEventListener('input', function() {
                checkUrlAvailabilityStatus(this.value);
            });
        }

        function generateUrl() {
            updateUrlPreview();
        }

        function startCountdown(date, time) {
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }
            
            const weddingDateTime = new Date(`${date}T${time}:00`);
            
            function updateCountdown() {
                const now = new Date();
                const diff = weddingDateTime - now;
                
                if (diff > 0) {
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                    
                    const daysEl = document.getElementById('days');
                    const hoursEl = document.getElementById('hours');
                    const minutesEl = document.getElementById('minutes');
                    const secondsEl = document.getElementById('seconds');
                    
                    if (daysEl) daysEl.textContent = days;
                    if (hoursEl) hoursEl.textContent = hours;
                    if (minutesEl) minutesEl.textContent = minutes;
                    if (secondsEl) secondsEl.textContent = seconds;
                } else {
                    // Casamento j√° aconteceu - mostrar mensagem especial
                    const countdownCards = document.getElementById('countdownCards');
                    const weddingDayMessage = document.getElementById('weddingDayMessage');
                    
                    if (countdownCards && weddingDayMessage) {
                        countdownCards.classList.add('hidden');
                        weddingDayMessage.classList.remove('hidden');
                    }
                    clearInterval(countdownInterval);
                }
            }
            
            updateCountdown();
            countdownInterval = setInterval(updateCountdown, 1000);
        }

        function getTimeAgo(dateString) {
            const now = new Date();
            const date = new Date(dateString);
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) return 'Agora';
            if (diffInSeconds < 3600) return `H√° ${Math.floor(diffInSeconds / 60)} min`;
            if (diffInSeconds < 86400) return `H√° ${Math.floor(diffInSeconds / 3600)}h`;
            if (diffInSeconds < 2592000) return `H√° ${Math.floor(diffInSeconds / 86400)} dias`;
            return date.toLocaleDateString('pt-BR');
        }

        function toggleCompanionSection() {
            const attendanceRadios = document.querySelectorAll('input[name="attendance"]');
            const companionSection = document.getElementById('companionSection');
            const companionTypeRadios = document.querySelectorAll('input[name="companionType"]');
            const oneCompanionSection = document.getElementById('oneCompanionSection');
            const multipleCompanionsSection = document.getElementById('multipleCompanionsSection');
            const companionCountSelect = document.getElementById('companionCount');
            
            attendanceRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.value === 'yes') {
                        companionSection.classList.remove('hidden');
                    } else {
                        companionSection.classList.add('hidden');
                        oneCompanionSection.classList.add('hidden');
                        multipleCompanionsSection.classList.add('hidden');
                    }
                });
            });
            
            companionTypeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    oneCompanionSection.classList.add('hidden');
                    multipleCompanionsSection.classList.add('hidden');
                    
                    if (this.value === 'one') {
                        oneCompanionSection.classList.remove('hidden');
                    } else if (this.value === 'multiple') {
                        multipleCompanionsSection.classList.remove('hidden');
                    }
                });
            });
            
            // Event listener para mudan√ßa no n√∫mero de acompanhantes
            if (companionCountSelect) {
                companionCountSelect.addEventListener('change', function() {
                    updateCompanionNameFields(parseInt(this.value));
                });
            }
        }
        
        function updateCompanionNameFields(count) {
            const container = document.getElementById('companionNamesContainer');
            container.innerHTML = '';
            
            for (let i = 1; i <= count; i++) {
                const fieldDiv = document.createElement('div');
                fieldDiv.innerHTML = `
                    <label class="block text-xs font-medium text-gray-600 mb-1">Nome do ${i}¬∫ Acompanhante</label>
                    <input type="text" id="companion${i}Name" placeholder="Nome completo" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm">
                `;
                container.appendChild(fieldDiv);
            }
        }
        
        function getCompanionNames() {
            const companionType = document.querySelector('input[name="companionType"]:checked')?.value;
            let companionNames = [];
            
            if (companionType === 'one') {
                const name = document.getElementById('companionName')?.value;
                if (name && name.trim()) {
                    companionNames.push(name.trim());
                }
            } else if (companionType === 'multiple') {
                const count = parseInt(document.getElementById('companionCount')?.value) || 0;
                for (let i = 1; i <= count; i++) {
                    const name = document.getElementById(`companion${i}Name`)?.value;
                    if (name && name.trim()) {
                        companionNames.push(name.trim());
                    }
                }
            }
            
            return companionNames;
        }

        async function exportGuestList(type = 'all') {
            if (!currentWedding) return;
            
            try {
                const result = await getRSVPs(currentWedding.id);
                if (!result.success) return;
                
                let rsvps = result.rsvps;
                
                // Filtrar por tipo
                if (type === 'confirmed') {
                    rsvps = rsvps.filter(r => r.attendance);
                } else if (type === 'declined') {
                    rsvps = rsvps.filter(r => !r.attendance);
                }
                
                // Gerar CSV
                const headers = ['Nome', 'Status', 'Acompanhante', 'Total Pessoas', 'Data', 'Mensagem'];
                const csvContent = [
                    headers.join(','),
                    ...rsvps.map(rsvp => [
                        `"${rsvp.guest_name}"`,
                        rsvp.attendance ? 'Confirmado' : 'N√£o Confirmado',
                        `"${rsvp.companion_name || '-'}"`,
                        rsvp.guest_count,
                        new Date(rsvp.created_at).toLocaleDateString('pt-BR'),
                        `"${rsvp.message || '-'}"`
                    ].join(','))
                ].join('\n');
                
                // Download
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `convidados_${type}_${currentWedding.custom_url}.csv`;
                a.click();
                window.URL.revokeObjectURL(url);
                
            } catch (error) {
                console.error('Erro ao exportar lista:', error);
                alert('Erro ao exportar lista de convidados');
            }
        }

        // Fun√ß√£o de exporta√ß√£o simples para demonstra√ß√£o
        function exportCSV() {
            exportGuestList('all');
        }
        
        // Fun√ß√£o para adicionar mensagem ao mural
        async function addMessageToWall(guestName, messageText) {
            const messagesList = document.getElementById('messagesList');
            const noMessagesDiv = document.getElementById('noMessagesMessage');
            
            // Esconder mensagem de "sem recados"
            if (noMessagesDiv) {
                noMessagesDiv.classList.add('hidden');
            }
            
            // Criar nova mensagem
            const colors = ['purple', 'blue', 'green', 'red', 'yellow', 'indigo'];
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            const initial = guestName.charAt(0).toUpperCase();
            
            const newMessage = document.createElement('div');
            newMessage.className = `bg-white rounded-xl shadow-lg p-6 border-l-4 border-${randomColor}-500`;
            newMessage.innerHTML = `
                <div class="flex items-start space-x-4">
                    <div class="w-12 h-12 bg-${randomColor}-100 rounded-full flex items-center justify-center flex-shrink-0">
                        <span class="text-${randomColor}-600 font-bold text-lg">${initial}</span>
                    </div>
                    <div class="flex-1">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-bold text-gray-800 text-lg">${guestName}</h4>
                            <span class="text-sm text-gray-500">agora</span>
                        </div>
                        <p class="text-gray-700 leading-relaxed">${messageText}</p>
                    </div>
                </div>
            `;
            
            // Adicionar no topo da lista
            messagesList.insertBefore(newMessage, messagesList.firstChild);
        }
        
        // Fun√ß√£o para copiar IBAN
        async function copyIBAN() {
            const ibanElement = document.getElementById('ibanDisplay');
            const iban = ibanElement.textContent;
            
            try {
                if (navigator.clipboard) {
                    await navigator.clipboard.writeText(iban);
                    // Feedback visual
                    const originalText = ibanElement.textContent;
                    ibanElement.textContent = '‚úÖ Copiado!';
                    ibanElement.style.color = '#059669';
                    
                    setTimeout(() => {
                        ibanElement.textContent = originalText;
                        ibanElement.style.color = '';
                    }, 2000);
                } else {
                    // Fallback para navegadores mais antigos
                    const textArea = document.createElement('textarea');
                    textArea.value = iban;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    alert('‚úÖ IBAN copiado para a √°rea de transfer√™ncia!');
                }
            } catch (error) {
                console.error('Erro ao copiar IBAN:', error);
                alert('‚ùå Erro ao copiar IBAN. Tente selecionar e copiar manualmente.');
            }
        }

        // Fun√ß√£o para copiar URL do site
        async function copySiteUrl() {
            if (!currentWedding) return;
            
            const siteUrl = generateSiteUrl(currentWedding.custom_url);
            
            try {
                if (navigator.clipboard) {
                    await navigator.clipboard.writeText(siteUrl);
                    alert('‚úÖ URL copiada para a √°rea de transfer√™ncia!');
                } else {
                    // Fallback para navegadores mais antigos
                    const textArea = document.createElement('textarea');
                    textArea.value = siteUrl;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    alert('‚úÖ URL copiada para a √°rea de transfer√™ncia!');
                }
            } catch (error) {
                console.error('Erro ao copiar URL:', error);
                alert('‚ùå Erro ao copiar URL. Tente selecionar e copiar manualmente.');
            }
        }
        
        // Atualizar URL no dashboard
        function updateSiteUrlDisplay() {
            if (currentWedding) {
                const urlDisplay = document.getElementById('siteUrlDisplay');
                if (urlDisplay) {
                    urlDisplay.textContent = currentWedding.custom_url;
                }
            }
        }

        // ========== FUN√á√ïES DO SUPABASE ==========
        async function createWedding(weddingData) {
            try {
                const { data, error } = await supabase
                    .from('weddings')
                    .insert([{
                        username: weddingData.username,
                        password: weddingData.password, // ‚ö†Ô∏è Sem hash por simplicidade
                        groom_name: weddingData.groomName,
                        bride_name: weddingData.brideName,
                        wedding_date: weddingData.date,
                        custom_url: weddingData.customUrl,
                        allow_companions: true,
                        companion_type: 'multiple',
                        confirm_message: 'Obrigado por confirmar sua presen√ßa!',
                        decline_message: 'Sentimos sua falta, mas entendemos.',
                        gifts_enabled: weddingData.giftsEnabled,
                        account_holder: weddingData.accountHolder,
                        iban: weddingData.iban
                    }])
                    .select()
                    .single();
                
                if (error) throw error;
                return { success: true, wedding: data };
            } catch (error) {
                console.error('Erro ao criar casamento:', error);
                return { success: false, error: error.message };
            }
        }

        async function loginAdmin(username, password) {
            try {
                const { data, error } = await supabase
                    .from('weddings')
                    .select('*')
                    .eq('username', username)
                    .eq('password', password) // ‚ö†Ô∏è Compara√ß√£o direta sem hash
                    .single();
                
                if (error) throw error;
                return { success: true, wedding: data };
            } catch (error) {
                console.error('Erro no login:', error);
                return { success: false, error: 'Usu√°rio ou senha incorretos' };
            }
        }

        async function getWeddingByUrl(customUrl) {
            try {
                const { data, error } = await supabase
                    .from('weddings')
                    .select('*')
                    .eq('custom_url', customUrl)
                    .single();
                
                if (error) throw error;
                return { success: true, wedding: data };
            } catch (error) {
                console.error('Erro ao buscar casamento:', error);
                return { success: false, error: error.message };
            }
        }

        async function createRSVP(rsvpData) {
            try {
                const { data, error } = await supabase
                    .from('rsvps')
                    .insert([{
                        wedding_id: rsvpData.weddingId,
                        guest_name: rsvpData.guestName,
                        companion_name: rsvpData.companionName || null,
                        guest_count: rsvpData.guestCount || 1,
                        attendance: rsvpData.attendance,
                        message: rsvpData.message || null
                    }])
                    .select()
                    .single();
                
                if (error) throw error;
                return { success: true, rsvp: data };
            } catch (error) {
                console.error('Erro ao criar RSVP:', error);
                return { success: false, error: error.message };
            }
        }

        async function createMessage(messageData) {
            try {
                const { data, error } = await supabase
                    .from('messages')
                    .insert([{
                        wedding_id: messageData.weddingId,
                        guest_name: messageData.name,
                        message: messageData.message
                    }])
                    .select()
                    .single();
                
                if (error) throw error;
                return { success: true, message: data };
            } catch (error) {
                console.error('Erro ao criar mensagem:', error);
                return { success: false, error: error.message };
            }
        }

        async function getMessages(weddingId) {
            try {
                const { data, error } = await supabase
                    .from('messages')
                    .select('*')
                    .eq('wedding_id', weddingId)
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                return { success: true, messages: data };
            } catch (error) {
                console.error('Erro ao buscar mensagens:', error);
                return { success: false, error: error.message };
            }
        }

        async function getRSVPs(weddingId) {
            try {
                const { data, error } = await supabase
                    .from('rsvps')
                    .select('*')
                    .eq('wedding_id', weddingId)
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                return { success: true, rsvps: data };
            } catch (error) {
                console.error('Erro ao buscar RSVPs:', error);
                return { success: false, error: error.message };
            }
        }

        async function checkUrlAvailability(customUrl) {
            try {
                const { data, error } = await supabase
                    .from('weddings')
                    .select('id')
                    .eq('custom_url', customUrl)
                    .single();
                
                // Se encontrou dados, URL j√° existe
                return { available: false };
            } catch (error) {
                // Se n√£o encontrou, URL est√° dispon√≠vel
                return { available: true };
            }
        }

        // ========== EVENT LISTENERS ==========
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar funcionalidades
            toggleCompanionSection();
            
            // Event listener para cria√ß√£o de casamento
            document.getElementById('createWeddingForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const weddingData = {
                    groomName: document.getElementById('groomName').value,
                    brideName: document.getElementById('brideName').value,
                    date: document.getElementById('weddingDate').value,
                    customUrl: document.getElementById('customUrl').value,
                    username: document.getElementById('username').value,
                    password: document.getElementById('password').value,
                    giftsEnabled: true, // Por padr√£o ativado
                    accountHolder: document.getElementById('groomName').value + ' ' + document.getElementById('brideName').value,
                    iban: 'AO06 0040 0000 1234 5678 1011 2' // IBAN padr√£o angolano
                };
                
                // Valida√ß√µes
                if (weddingData.password.length < 6) {
                    alert('A senha deve ter pelo menos 6 caracteres');
                    return;
                }
                
                const urlCheck = await checkUrlAvailability(weddingData.customUrl);
                if (!urlCheck.available) {
                    alert('Esta URL j√° est√° em uso. Escolha outra.');
                    return;
                }
                
                const result = await createWedding(weddingData);
                if (result.success) {
                    currentWedding = result.wedding;
                    const siteUrl = generateSiteUrl(result.wedding.custom_url);
                    
                    // Mostrar URL do site criado
                    const message = `üéâ Site de casamento criado com sucesso!\n\n` +
                                  `üì± URL do seu site:\n${siteUrl}\n\n` +
                                  `üí° Compartilhe este link com seus convidados!\n\n` +
                                  `Redirecionando para o painel administrativo...`;
                    
                    alert(message);
                    
                    // Copiar URL para clipboard se poss√≠vel
                    if (navigator.clipboard) {
                        navigator.clipboard.writeText(siteUrl).catch(() => {});
                    }
                    
                    showDashboard();
                } else {
                    alert('Erro ao criar site: ' + result.error);
                }
            });

            // Event listener para login
            document.getElementById('loginForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                
                const result = await loginAdmin(username, password);
                if (result.success) {
                    currentWedding = result.wedding;
                    showDashboard();
                } else {
                    alert('Usu√°rio ou senha incorretos');
                }
            });

            // Event listener para RSVP
            document.getElementById('rsvpForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const guestName = document.getElementById('guestName').value;
                const attendanceValue = document.querySelector('input[name="attendance"]:checked')?.value;
                
                if (!attendanceValue) {
                    alert('Por favor, selecione se voc√™ vir√° ou n√£o');
                    return;
                }
                
                let companionNames = [];
                let guestCount = 1;
                
                if (attendanceValue === 'yes') {
                    const companionType = document.querySelector('input[name="companionType"]:checked')?.value;
                    
                    if (companionType === 'one') {
                        const singleCompanion = document.getElementById('companionName').value;
                        if (singleCompanion && singleCompanion.trim()) {
                            companionNames.push(singleCompanion.trim());
                            guestCount = 2;
                        }
                    } else if (companionType === 'multiple') {
                        const selectedCount = parseInt(document.getElementById('companionCount').value) || 0;
                        companionNames = getCompanionNames();
                        guestCount = 1 + selectedCount; // Convidado principal + acompanhantes
                    }
                }
                
                const rsvpData = {
                    weddingId: currentWedding?.id || 1, // Para demo
                    guestName: guestName,
                    companionName: companionNames.length > 0 ? companionNames.join(', ') : null,
                    companionNames: companionNames, // Array com todos os nomes
                    guestCount: guestCount,
                    attendance: attendanceValue === 'yes',
                    message: document.getElementById('rsvpMessage').value || null
                };
                
                const result = await createRSVP(rsvpData);
                if (result.success) {
                    // Mensagem personalizada baseada na confirma√ß√£o
                    let message = '';
                    if (attendanceValue === 'yes') {
                        message = `üéâ Obrigado, ${guestName}! Sua presen√ßa foi confirmada com sucesso!\n\nEstamos ansiosos para celebrar este momento especial com voc√™!`;
                    } else {
                        message = `üíô Obrigado por nos avisar, ${guestName}. Sentiremos sua falta!\n\nSabemos que voc√™ estar√° conosco em pensamento neste dia especial.`;
                    }
                    
                    alert(message);
                    
                    // Se h√° mensagem, adicionar ao mural automaticamente
                    const messageText = document.getElementById('rsvpMessage').value;
                    if (messageText && messageText.trim()) {
                        await addMessageToWall(guestName, messageText);
                    }
                    
                    // Reset do formul√°rio
                    document.getElementById('rsvpForm').reset();
                    document.getElementById('companionSection').classList.add('hidden');
                    document.getElementById('oneCompanionSection').classList.add('hidden');
                    document.getElementById('multipleCompanionsSection').classList.add('hidden');
                } else {
                    alert('Erro ao enviar confirma√ß√£o: ' + result.error);
                }
            });

            // Event listener para controlo de acompanhantes
            const allowCompanionsCheckbox = document.getElementById('allowCompanions');
            const companionsConfig = document.getElementById('companionsConfig');
            
            allowCompanionsCheckbox.addEventListener('change', function() {
                if (this.checked) {
                    companionsConfig.style.display = 'block';
                } else {
                    companionsConfig.style.display = 'none';
                }
            });

            // Event listener para controlo de presentes
            const enableGiftsCheckbox = document.getElementById('enableGifts');
            const giftsConfig = document.getElementById('giftsConfig');
            
            enableGiftsCheckbox.addEventListener('change', function() {
                if (this.checked) {
                    giftsConfig.style.display = 'block';
                } else {
                    giftsConfig.style.display = 'none';
                }
            });

            // Event listener para mensagens
            document.getElementById('messageForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const messageData = {
                    weddingId: currentWedding?.id || 1, // Para demo
                    name: document.getElementById('messageName').value,
                    message: document.getElementById('messageText').value
                };
                
                const result = await createMessage(messageData);
                if (result.success) {
                    alert('Mensagem enviada com sucesso!');
                    document.getElementById('messageForm').reset();
                    
                    // Adicionar mensagem √† lista imediatamente
                    const messagesList = document.getElementById('messagesList');
                    const newMessage = document.createElement('div');
                    newMessage.className = 'bg-white border rounded-lg p-4 card-shadow';
                    newMessage.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-semibold text-gray-800">${messageData.name}</h4>
                            <span class="text-sm text-gray-500">Agora</span>
                        </div>
                        <p class="text-gray-600">${messageData.message}</p>
                    `;
                    messagesList.insertBefore(newMessage, messagesList.firstChild);
                } else {
                    alert('Erro ao enviar mensagem: ' + result.error);
                }
            });
            
            // Inicializar aplica√ß√£o (detecta se √© site espec√≠fico ou p√°gina inicial)
            initializeApp();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9721b76e93ac77d7',t:'MTc1NTY5MTA4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
